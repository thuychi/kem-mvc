/* file config: sudo nano /etc/redis/redis.conf */
var define = require('../../index.js').define.redis;
var Redis = require('redis-fast-driver');
var DATABASE = {};

function Database(name) {
	var redis = new Redis({
		port: define.port,
		host: define.host
	});
	redis.rawCall(['select', name]);
	return function (...array) {
		return new Promise(function (resolve, reject) {
			redis.rawCall(array, function (error, row) {
				error ? reject(error) : row ? resolve(row) : reject();
			});
		});
	};
};

DATABASE = new Database(0);
DATABASE.array = function (array) {
	return Promise.all(array);
};

define.table.forEach(function(table, index){
	DATABASE[table] = new Database(index);
});

module.exports = DATABASE;